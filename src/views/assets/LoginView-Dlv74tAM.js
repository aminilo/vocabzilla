var x=(b,m,n)=>new Promise((c,a)=>{var v=r=>{try{t(n.next(r))}catch(l){a(l)}},o=r=>{try{t(n.throw(r))}catch(l){a(l)}},t=r=>r.done?c(r.value):Promise.resolve(r.value).then(v,o);t((n=n.apply(b,m)).next())});import{a as P,r as g,e as d,g as s,k as f,l as y,w as V,I as h,J as E,t as k,K as L,p as _,L as q,q as C,u as B,i as D,f as p}from"./vue-vendors-BgzxvA44.js";import{u as N,a as M}from"./index-DZ5Qr93C.js";import{a as T}from"./useFieldErrors-Dv9JVHjh.js";import"./socket-CF4wHI2V.js";const j={class:"page-container bg"},A={class:"form-box"},R={class:"mb-2"},z={key:0,class:"input-error"},F={class:"mb-4 relative"},I=["type"],U={key:0,class:"input-error"},Z={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},J={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},K={key:0,class:"text-red-500 mt-4 text-center"},W=P({__name:"LoginView",setup(b){const m=N(),n=B(),c=D(),a=g(!1),v=()=>a.value=!a.value,o=g({email:"",password:""}),t=g({email:"",password:"",general:""}),r=()=>x(null,null,function*(){var l,e;if(t.value.email=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.value.email)?"":"Invalid email format.",t.value.password=o.value.password.length>0?"":"Password is required.",!(t.value.email||t.value.password))try{yield M.get("/csrf-token");const i=yield M.post("/auth/login",o.value),{user:u,token:w}=i.data;m.login(u,w),yield m.fetchProfile();const S=n.query.redirect||"/";c.push(S),setTimeout(()=>window.location.reload(),10)}catch(i){const w=(e=(l=i.response)==null?void 0:l.data)==null?void 0:e.error;w?T(w,t.value):t.value.general="Something went wrong"}});return(l,e)=>{const i=q("router-link");return p(),d("div",j,[s("div",A,[e[9]||(e[9]=s("h3",{class:"text-2xl font-bold text-center mb-6"},"Log in",-1)),s("form",{onSubmit:V(r,["prevent"])},[s("div",R,[e[2]||(e[2]=s("label",{for:"email",class:"input-label"},"Email",-1)),h(s("input",{required:"",id:"email",type:"email","onUpdate:modelValue":e[0]||(e[0]=u=>o.value.email=u),class:"input-field"},null,512),[[E,o.value.email]]),t.value.email?(p(),d("p",z,k(t.value.email),1)):f("",!0)]),s("div",F,[e[5]||(e[5]=s("label",{for:"password",class:"input-label"},"Password",-1)),h(s("input",{required:"",id:"password",type:a.value?"text":"password","onUpdate:modelValue":e[1]||(e[1]=u=>o.value.password=u),class:"input-field"},null,8,I),[[L,o.value.password]]),t.value.password?(p(),d("p",U,k(t.value.password),1)):f("",!0),s("button",{type:"button",onClick:v,class:"toggleShowPass"},[a.value?(p(),d("svg",Z,e[3]||(e[3]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"},null,-1)]))):(p(),d("svg",J,e[4]||(e[4]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"},null,-1)])))])]),e[6]||(e[6]=s("button",{type:"submit",class:"form-btn center-btn"},"Log in",-1))],32),t.value.general?(p(),d("p",K,k(t.value.general),1)):f("",!0),y(i,{to:"/forgot-password",class:"block text-center text-blue-500 hover:underline p-1 mt-4"},{default:_(()=>e[7]||(e[7]=[C("Forgot Password?")])),_:1}),y(i,{to:"/register",class:"login-register-redirect"},{default:_(()=>e[8]||(e[8]=[C("← Register")])),_:1})])])}}});export{W as default};
