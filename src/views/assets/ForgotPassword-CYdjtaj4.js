var y=(_,f,l)=>new Promise((b,r)=>{var o=e=>{try{t(l.next(e))}catch(u){r(u)}},i=e=>{try{t(l.throw(e))}catch(u){r(u)}},t=e=>e.done?b(e.value):Promise.resolve(e.value).then(o,i);t((l=l.apply(_,f)).next())});import{a as h,u as S,r as c,e as d,g as a,k as p,w as I,I as q,J as R,t as m,q as V,i as B,f as v}from"./vue-vendors-BgzxvA44.js";import{a as k}from"./index-DcgwpPrI.js";import"./socket-CF4wHI2V.js";const D={class:"page-container bg"},F={class:"form-box"},M={class:"mb-4 relative"},N={key:0,class:"input-error"},C=["disabled"],E={key:0,class:"text-red-500 mt-4 text-center"},P={key:1,class:"text-green-600 text-center mt-4"},T={class:"font-bold"},J={key:0},z=h({__name:"ForgotPassword",setup(_){const f=B(),l=S(),b=typeof l.query.token=="string"?l.query.token:"",r=c(""),o=c(!1),i=c({email:"",token:b}),t=c({email:"",general:""}),e=c(5);let u;const x=()=>y(null,null,function*(){var g,s;if(!o.value){if(o.value=!0,t.value.email=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value.email)?"":"Invalid email format.",t.value.email){o.value=!1;return}try{yield k.get("/csrf-token");const n=yield k.post("/auth/forgot-password",i.value),{msg:w}=n.data;r.value=w||"We sent a link to your email; check your inbox.",u=window.setInterval(()=>{e.value--,e.value<=0&&(clearInterval(u),f.push("/login"))},1e3)}catch(n){t.value.general=((s=(g=n==null?void 0:n.response)==null?void 0:g.data)==null?void 0:s.error)||"Reset Failed."}finally{o.value=!1}}});return(g,s)=>(v(),d("div",D,[a("div",F,[s[3]||(s[3]=a("h3",{class:"text-2xl font-bold text-center mb-6"},"Forgot Password",-1)),a("form",{onSubmit:I(x,["prevent"])},[a("div",M,[s[1]||(s[1]=a("label",{for:"email",class:"input-label"},"Email",-1)),q(a("input",{required:"",id:"email",type:"email","onUpdate:modelValue":s[0]||(s[0]=n=>i.value.email=n),class:"input-field"},null,512),[[R,i.value.email]]),t.value.email?(v(),d("p",N,m(t.value.email),1)):p("",!0)]),a("button",{disabled:o.value,type:"submit",class:"form-btn center-btn"},m(o.value?"Submitting...":"Submit"),9,C)],32),t.value.general?(v(),d("p",E,m(t.value.general),1)):p("",!0),r.value?(v(),d("div",P,[a("p",null,m(r.value),1),s[2]||(s[2]=a("br",null,null,-1)),a("p",T,[V("Redirecting to login in "+m(e.value)+" second",1),e.value>1?(v(),d("span",J,"s")):p("",!0)])])):p("",!0)])]))}});export{z as default};
