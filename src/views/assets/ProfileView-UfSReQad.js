var S=(_,r,o)=>new Promise((m,u)=>{var t=a=>{try{i(o.next(a))}catch(d){u(d)}},v=a=>{try{i(o.throw(a))}catch(d){u(d)}},i=a=>a.done?m(a.value):Promise.resolve(a.value).then(t,v);i((o=o.apply(_,r)).next())});import{a as L,r as c,e as n,g as s,l as N,p as z,L as D,t as w,m as E,I as h,M as I,k as y,w as T,J as Z,K as B,q as F,f as l}from"./vue-vendors-BgzxvA44.js";import{u as J,a as V,_ as q}from"./index-DcgwpPrI.js";import{a as H}from"./useFieldErrors-Dv9JVHjh.js";import"./socket-CF4wHI2V.js";const K={class:"wrapper bg"},O={class:"container mx-auto text-center bg-gradient-light dark:bg-gradient-dark p-2 py-2 sm:px-6 md:px-8 lg:max-w-3xl"},R={class:"goBackLink"},Y={class:"p-1 profile-header"},$={class:"profile-card"},G={class:"form-box mx-auto"},Q={class:"mb-2"},W={key:0,class:"input-error"},X={class:"relative"},ee=["type"],se={key:0,class:"input-error"},te={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},oe={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},re={class:"relative"},ae=["type"],ne={key:0,class:"input-error"},le={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},ue={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},ie={key:0,class:"success-message"},de=L({__name:"ProfileView",setup(_){var b,P;const r=J(),o=c((P=(b=r.user)==null?void 0:b.username)!=null?P:""),m=c(""),u=c(""),t=c({username:"",currentPassword:"",password:"",general:""}),v=c(""),i=c(!1),a=()=>i.value=!i.value,d=c(!1),U=()=>d.value=!d.value,f=c(!1),j=()=>f.value=!f.value,A=()=>S(null,null,function*(){var e,k,p;const C=o.value!==((e=r.user)==null?void 0:e.username)||m.value.trim()!==""||u.value.trim()!=="";if(o.value.trim()===""){t.value.username="Username cannot be empty.";return}if(C)try{const x=yield V.get("/csrf-token",{withCredentials:!0}),{csrfToken:M}=yield x.data,g={username:o.value,currentPassword:m.value,password:u.value};yield V.patch("/auth/profile",g,{headers:{Authorization:`Bearer ${r.token}`,"x-csrf-token":M},withCredentials:!0}),m.value="",u.value="",t.value={username:"",currentPassword:"",password:"",general:""},v.value="Profile updated successfully!",setTimeout(()=>v.value="",4e3),r.user.username=o.value,r.user&&localStorage.setItem("user",JSON.stringify(r.user))}catch(x){const g=(p=(k=x.response)==null?void 0:k.data)==null?void 0:p.error;g?H(g,t.value):t.value.general="Something went wrong"}});return(C,e)=>{const k=D("router-link");return l(),n("div",K,[s("div",O,[s("div",R,[N(k,{to:"/",class:""},{default:z(()=>e[3]||(e[3]=[F(" ← Back to Home ")])),_:1})]),s("div",Y,[s("h2",null,w(E(r).user.username)+"'s Profile",1),e[4]||(e[4]=s("p",null,"Manage your account information and preferences.",-1))]),s("section",$,[s("button",{onClick:j,class:"toggle-button"},w(f.value?"↑":"↓"),1),e[14]||(e[14]=s("hr",{class:"divider"},null,-1)),h(s("div",G,[e[13]||(e[13]=s("h3",{class:"section-title"},"User Information",-1)),s("form",{onSubmit:T(A,["prevent"]),class:"my-8 space-y-4"},[s("div",Q,[e[5]||(e[5]=s("label",{class:"input-label",for:"username"},"Username",-1)),h(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=p=>o.value=p),type:"text",class:"input-field",placeholder:"Your Username"},null,512),[[Z,o.value]]),t.value.username?(l(),n("p",W,w(t.value.username),1)):y("",!0)]),s("div",X,[e[8]||(e[8]=s("label",{class:"input-label",for:"currentPassword"},"Current Password",-1)),h(s("input",{id:"currentPassword","onUpdate:modelValue":e[1]||(e[1]=p=>m.value=p),type:d.value?"text":"password",class:"input-field",placeholder:"Current Password"},null,8,ee),[[B,m.value]]),t.value.currentPassword?(l(),n("p",se,w(t.value.currentPassword),1)):y("",!0),s("button",{type:"button",onClick:U,class:"toggleShowPass"},[d.value?(l(),n("svg",te,e[6]||(e[6]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"},null,-1)]))):(l(),n("svg",oe,e[7]||(e[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"},null,-1)])))])]),s("div",re,[e[11]||(e[11]=s("label",{class:"input-label",for:"password"},"Password",-1)),h(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=p=>u.value=p),type:i.value?"text":"password",class:"input-field",placeholder:"New Password"},null,8,ae),[[B,u.value]]),t.value.password?(l(),n("p",ne,w(t.value.password),1)):y("",!0),s("button",{type:"button",onClick:a,class:"toggleShowPass"},[i.value?(l(),n("svg",le,e[9]||(e[9]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"},null,-1)]))):(l(),n("svg",ue,e[10]||(e[10]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"},null,-1)])))])]),e[12]||(e[12]=s("button",{type:"submit",class:"form-btn center-btn"},"Update Profile",-1))],32),v.value?(l(),n("p",ie,w(v.value),1)):y("",!0)],512),[[I,f.value]])])])])}}}),fe=q(de,[["__scopeId","data-v-149a301e"]]);export{fe as default};
