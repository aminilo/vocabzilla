var k=(x,o,l)=>new Promise((n,c)=>{var i=a=>{try{u(l.next(a))}catch(p){c(p)}},d=a=>{try{u(l.throw(a))}catch(p){c(p)}},u=a=>a.done?n(a.value):Promise.resolve(a.value).then(i,d);u((l=l.apply(x,o)).next())});import{a as A,j as B,L as M,p as S,q as v,t as N,f as s,r,u as I,c as R,v as C,o as V,E as $,e as m,g as h,I as q,l as L,J as K,F as U,G as Z,m as j,D as G}from"./vue-vendors-BgzxvA44.js";import{a as J,_ as O}from"./index-DcgwpPrI.js";import{d as Q,_ as X}from"./debounce-Cvi6_DbW.js";import{a as T}from"./anime-DaNXu8ZO.js";import"./socket-CF4wHI2V.js";const W=A({__name:"HanziCard",props:{char:{}},setup(x){return(o,l)=>{const n=M("router-link");return s(),B(n,{to:`/ch/hanzi/${o.char}`,class:"text-2xl md:text-3xl xl:text-5xl cursor-pointer select-non"},{default:S(()=>[v(N(o.char),1)]),_:1},8,["to"])}}}),Y={class:"page-container min-h-screen py-20 bg"},ee={class:"container mx-auto my-8 p-4 text-center"},te={class:"goBackLink"},ae=["placeholder"],re={key:0,class:"text-xl text-gray-400 mb-4 flex items-center animate-pulse"},ne={class:"mt-8 text-base md:text-lg lg:text-xl"},se=A({__name:"HanziPage",setup(x){const o=I(),l=r(null),n=r(null),c=r(""),i=r(!1),d=r([]),u=r(1),a=r(Number(o.query.pageSize)||20),p=r(!1),b=/Mobi|Android/i.test(navigator.userAgent),w=navigator.platform.toUpperCase().includes("MAC"),P=R(()=>`Search ${b?"":w?"(⌘+/)":"(Ctrl+/)"}`),z=e=>{(e.key===" "||e.key==="Enter")&&(e.preventDefault(),f())},E=e=>{var g;(w?e.metaKey:e.ctrlKey)&&e.key==="/"&&(e.preventDefault(),(g=n.value)==null||g.focus())},_=r(null),D=()=>{if(!_.value)return;const e=_.value.querySelectorAll(".hanzi-line");e.length&&T({targets:e,opacity:[0,1],translateX:[-30,0],easing:"easeOutExpo",duration:444,delay:T.stagger(111)})},f=()=>k(null,null,function*(){var e;if(!i.value){i.value=!0;try{const{data:t}=yield J.get("/ch/hanzi",{params:{page:u.value,pageSize:a.value,search:c.value}});((e=t.characters)==null?void 0:e.length)<a.value&&(p.value=!0),Array.isArray(t.characters)?(d.value.push(...t.characters),u.value++):console.warn("No characters returned:",t),yield G(),setTimeout(()=>{D()},10)}catch(t){console.error("Failed to fetch characters:",t)}finally{i.value=!1}}}),F=()=>{d.value=[],u.value=1,p.value=!1,i.value=!1,f()};return C(c,Q(()=>F(),300)),C(()=>o.fullPath,()=>{setTimeout(()=>{var e;return(e=n.value)==null?void 0:e.focus()},0)}),V(()=>k(null,null,function*(){var e;(e=n.value)==null||e.focus(),f(),window.addEventListener("keydown",z),window.addEventListener("keydown",E)})),$(()=>{window.removeEventListener("keydown",z),window.removeEventListener("keydown",E)}),(e,t)=>{const g=M("router-link");return s(),m("main",Y,[h("div",ee,[h("div",te,[L(g,{to:"/"},{default:S(()=>t[1]||(t[1]=[v(" ← Back to Home ")])),_:1})]),q(h("input",{ref_key:"searchInput",ref:n,"onUpdate:modelValue":t[0]||(t[0]=y=>c.value=y),placeholder:P.value,class:"max-w-[250px] text-center text-xl p-4 rounded-lg mb-6 ring-2 hover:ring-4 border-amber-600 bg-transparent focus:outline-none focus:border-amber-500"},null,8,ae),[[K,c.value]]),i.value&&d.value.length===0?(s(),m("div",re,[L(X,{text:"Loading Hanzi..."})])):(s(),m("div",{key:1,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-8 xl:grid-cols-10 2xl:grid-cols-12 gap-4 p-4 text-2xl text-center",ref_key:"hanZiRef",ref:_},[(s(!0),m(U,null,Z(d.value,(y,H)=>(s(),B(W,{key:H,char:y.hanzi,class:"hanzi-line"},null,8,["char"]))),128))],512)),h("div",ne,[j(b)?(s(),m("button",{key:0,onClick:f,class:"border border-gray-500 px-3 py-1 rounded hover:bg-gradient-light dark:hover:bg-gradient-dark"}," Load More ")):(s(),m("p",{key:1,ref_key:"hintTxt",ref:l,class:"animate-bounce"},t[2]||(t[2]=[v(" Press "),h("strong",{class:"p-1"},"Enter",-1),v(" to Load more batch ")]),512))])])])}}}),pe=O(se,[["__scopeId","data-v-2b011abe"]]);export{pe as default};
